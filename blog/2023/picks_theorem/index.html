<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Pick's Theorem | Haricharan Balasundaram</title> <meta name="author" content="Haricharan Balasundaram"> <meta name="description" content="An elegant theorem on 2-D integer lattices"> <meta name="keywords" content="academic-website, science-blog"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light"> <link href="/assets/css/bootstrap-toc.min.css?6f5af0bb9aab25d79b2448143cbeaa88" rel="stylesheet"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://haricharan1212.github.io//blog/2023/picks_theorem/"> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">Haricharan Balasundaram</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">Blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">Projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/assets/pdf/cv_haricharan.pdf">CV</a> </li> <li class="nav-item "> <a class="nav-link" href="/sessions/">Sessions</a> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="row"> <div class="col-sm-3"> <nav id="toc-sidebar" class="sticky-top"></nav> </div> <div class="col-sm-9"> <div class="post"> <header class="post-header"> <h1 class="post-title">Pick's Theorem</h1> <p class="post-meta">December 18, 2023</p> <p class="post-tags"> <a href="/blog/2023"> <i class="fa-solid fa-calendar fa-sm"></i> 2023 </a>   ·   <a href="/blog/tag/math"> <i class="fa-solid fa-hashtag fa-sm"></i> Math</a>   </p> </header> <article class="post-content"> <div id="markdown-content"> <blockquote> <p>Given a Simple polygon with its points on a 2D integer lattice, find the <strong>Number of Lattice Points</strong> interior to the polygon.</p> </blockquote> <p><em>Note:</em> A lattice is just a set \(\{(x, y): x, y\text{ are both integers} \}\)</p> <p>The Premise:</p> <ul> <li>Calculating the area of the polygon</li> <li>Finding the number of boundary points</li> <li>Using a very interesting theorem to get our answer</li> </ul> <p>Good luck reading!</p> <hr> <h2 id="area-of-a-general-polygon">Area of a general polygon</h2> <h4 id="area-of-a-triangle">Area of a triangle</h4> <p>A triangle is a nice convex figure, which allows us to compute its area in a clean manner. The magnitude of the cross product \(\vec a \times \vec b\) gives us the area of the parallelogram with sides along \(\vec a\) and \(\vec b\).</p> <p>For a triangle with coordinates at \(\vec p_1 = (x_1, y_1), \vec p_1 = (x_2, y_2), \vec p_1 = (x_3, y_3)\), the area would be half the area of the parallelogram formed by \(\vec p_1 - \vec p_2\) and \(\vec p_1 - \vec p_3\), which is:</p> \[A_{123} = \frac 12 mag((\vec p_1 - \vec p_2) \times (\vec p_1 - \vec p_3)) = abs \frac 12 \left ( (x_2 - x_1) (y_3 - y_1) - (y_2 - y_1) (x_3 - x_1) \right )\] <p>This can be written succintly as \(\boxed{ \frac 12 abs \left ( \sum_{i = 1} ^ 3 x_{i} y_{i + 1} - x_{i + 1} y_i \right )}\), with the indices wrapping modulo \(3\) (i.e. \(x_4 = x_1, y_4 = y_1\)).</p> <p><em>Note:</em> we will assume throughout that \(x_{n + 1} = x_1\), i.e. indices wrap modulo \(n\).</p> <hr> <h4 id="area-of-a-polygon">Area of a polygon</h4> <p>A natural suggestion for the area of a \(n\)-sided polygon might be this:</p> <ol> <li>Divide up the polygon into triangles. This division will be of the following form: We pick a “base point” say \(\vec p_1\), sort the points in anti-clockwise order of their angles from the fixed base point and iterate over the base line, which would be the line joining \((\vec p_2 \text{ and } \vec p_3), (\vec p_3 \text{ and } \vec p_4) \dots (\vec p_{n - 1} \text{ and } \vec p_n)\) respectively.</li> <li>Sum up the areas of each of the triangles</li> </ol> <p>This seems reasonable but has a slight caveat. It works only for convex polygons. In case of concave polygons, we might be overcounting the areas!</p> <p>Now, let’s think about the ominous \(abs\) at the front and try to tackle it. Let’s just remove the \(abs\) and see what it really means. It just means that we’d take the signed area, i.e. the order in which we take our vectors matters! This would work only if \(\vec p_1 - \vec p_2\) and \(\vec p_1 - \vec p_3\) are anti-clockwise in order for each of the polygons.</p> <p>In the off-chance that \(\vec p_1 - \vec p_i\) and \(\vec p_1 - \vec p_{i + 1}\) are clock-wise, that can only indicate non-convexity. But in that case, we would want to subtract the area anyways! So our signs are accounted for, and we’re golden.</p> <p>Finally, our area is (\(S_{ijk}\) indicates the signed area of the triangle formed by the points \(P_i, P_j, P_k\)):</p> \[S = S_{123} + S_{134} + \dots + S_{1(n - 1)n} = \frac 12 \sum_{i = 2}^{n - 1} \left ((-x_{i} y_1 + x_{i + 1} y_1 + x_1 y_{i} - x_{i + 1} y_{i} - x_1 y_{i + 1} + x_{i} y_{i + 1} ) \right )\] <p>Have you spotted it yet? Most of the terms in the above expression cancel out. \(-x_{i} y_1\) would cancel out with \(x_{i + 1} y_1\) in most of the cases, except when \(i = 2\) or \(i = n - 1\).</p> <p>Using this:</p> \[S = \frac 12 \left (-x_2 y_1 + x_n y_1 + x_1 y_2 - x_1 y_n \sum_{i = 2}^{n - 1} (- x_{i + 1} y_{i} + x_{i} y_{i + 1}) \right ) = \boxed{\frac 12 \left ( \sum_{i = 1} ^ n x_{i} y_{i + 1} - x_{i + 1} y_i \right )}\] <p>And yes, $\vec p_{n + 1} = \vec p_1$, the indices do wrap around.</p> <p>We generally don’t care about the order of the points (i.e. clockwise or anti-clockwise), so to avoid confusion, let’s put a modulus on the above expression: \(S = \boxed{\frac 12 abs \left ( \sum_{i = 1} ^ n x_{i} y_{i + 1} - x_{i + 1} y_i \right )}\)</p> <hr> <h2 id="number-of-boundary-points">Number of boundary points</h2> <h4 id="number-of-lattice-points-between-a-point-and-the-origin">Number of lattice points between a point and the origin</h4> <p>Consider a point \(\vec p_1 = (x_1, y_1)\), we will find the number of lattice points between the origin and \(\vec p\) (exclusive of both).</p> <p>The equation of this line is \(\frac{x_1}{x} = \frac{y_1}{y}\).</p> <p>To start with, if we set the above ratio to be equal to the \(g = \gcd(x_1, y_1)\), it certainly satisfies the equation. By definition, \(x = \frac{x_1}{g}\) and \(y = \frac{y_1}{g}\) are certainly integral.</p> <p>On the same token, \((k \frac{x_1}{g}, k \frac {y_1}g), 1 \le k \le g\) are also integral points satisfying the above equation, so they also work!</p> <p>We find \(g - 1\) many such points, for each of the values of \(k\).</p> <p><em>Note: We take the gcd of any two numbers (positive of negative) to be only positive. Also note that \(\gcd(0, c) = c\)</em></p> <h6 id="exercise-prove-that-there-arent-any-more-integral-points">Exercise: Prove that there aren’t any more integral points.</h6> <hr> <h4 id="number-of-lattice-points-between-two-points">Number of lattice points between two points</h4> <p>We did it for a point and the origin, for two general points \(\vec p_1, \vec p_2\), we could just do a coordinate shift and conclude that the number of lattice points is \(\gcd(x_2 - x_1, y_2 - y_1) - 1\).</p> <hr> <h4 id="number-of-boundary-points-in-a-polygon">Number of boundary points in a Polygon</h4> <p>Now, let’s do this for our polygon. The number of boundary points excluding the vertices would just be \(\sum_{i = 1}^n (\gcd(x_{i + 1} - x_i, y_{i + 1} - y_i) - 1)\), and including our vertices, our final expression is simply \(\boxed{\sum_{i = 1}^n \gcd(x_{i + 1} - x_i, y_{i + 1} - y_i)}\)</p> <hr> <h2 id="picks-theorem">Pick’s Theorem</h2> <p>For a simple polygon with Area \(A\), number of boundary points \(b\) and number of interior points \(i\),</p> \[\boxed{A = i + \frac b2 - 1}\] <p>This theorem is not very intuitive but is vaguely reminiscent of Euler’s characteristic for plane graphs.</p> <p>Let’s get into the proof. Consider Pick’s function \(f\) for a polygon \(P\) \(f(P) = A - (i + \frac b2 - 1)\)</p> <p>We will prove that this function is identically \(0\).</p> <p><em>Note:</em> This function is coordinate-transformation invariant (as long as the shift is by an integer amount, of course).</p> <hr> <h4 id="rectangle-with-edges-along-the-axes">Rectangle with edges along the axes</h4> <p>Consider a rectangle with \(R\) vertices \((0, 0), (0, x), (x, y), (0, y)\).</p> <p>Let’s calculate various quantities: \(b = 2 (x + y) A = xy i = (x - 1) (y - 1)\)</p> \[f(R) = xy - ((xy - x - y + 1) + \frac{2(x + y)}2 - 1) = 0\] <hr> <h4 id="additivity-of-picks-function">Additivity of Pick’s Function</h4> <p>Consider two polygons \(P_1, P_2\) which share atleast one edge.</p> <p>Let \(f(P_1) = A_1 - (i_1 + \frac {b_1}2 - 1), f(P_2) = A_2 - (i_2 + \frac {b_2}2 - 1)\) Now, for the combined polygon \(P\), we observe that it has the combined area of the two initial polygons. All the boundary points in common between the two polygons become interior points of the new polygon.</p> <p>From this, we observe that the sum of number of boundary points and the number of interior points remain the same (since there is a \(\frac 12\) which multiplies number of boundary points)</p> <p>This lets us conclude that \(f(P) = f(P_1) + f(P_2)\).</p> <h6 id="general-triangle">General triangle</h6> <h6 id="triangle-with-two-sides-along-axes">Triangle with two sides along axes</h6> <p>Consider a rectangle \(R\) with edges along axes. By utilizing the diagonal, let’s split it up into two triangles (\(T_1, T_2\)). Note that by symmetry, the area, number of boundary points, the number of interior points, and hence the Pick’s function for the two triangles are the same.</p> \[0 = f(R) = f(T_1) + f(T_2) \implies f(T_1) = 0\] <p>For a general triangle with vertices along lattice points, look at the below construction and conclude that the Picks’ function is zero.</p> <h4 id="putting-it-all-together">Putting it all together</h4> <p>For a general polygon, we can divide it up into smaller triangles, each of which has Pick’s function zero. Now, by additivity of Pick’s function, Pick’s function of the general polygon is \(0\).</p> <p>We’re done!</p> <blockquote> <p>The above theorem enables us to find the number of interior points, if we know the area and the number of boundary points. We’re done!</p> </blockquote> <h2 id="addenda">Addenda</h2> <p>Why is all this useful?</p> <p>It it very useful, but doesn’t need to be. I won’t go into the applications here. Math can be studied just for the sake of it!</p> </div> </article> </div> </div> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2025 Haricharan Balasundaram. Last updated: January 05, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script> <script defer src="/assets/js/bootstrap-toc.min.js?c82ff4de8b0955d6ff14f5b05eed7eb6"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?07b8786bab9b4abe90d10e61f7d12ff7" type="text/javascript"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script async src="https://www.googletagmanager.com/gtag/js?id="></script> <script>function gtag(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","");</script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>